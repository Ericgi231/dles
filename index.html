<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Dles</title>
  </head>
  <body>
    <h1 style="text-align: center">The Dles</h1>
    <p style="text-align: center">...they're anything but.</p>
    <details id="filterDetails" style="padding: 0.25rem" open>
      <summary class="not-selectable pointer" style="margin-bottom: 0.75rem">
        Filters (Work in progress)
      </summary>
      <div
        style="
          display: flex;
          flex-wrap: wrap;
          justify-content: space-between;
          row-gap: 0.5rem;
          line-height: 1;
        "
      >
        <div style="display: flex">
          <div id="includedFilterLabel" class="filterLabel">
            tags <strong>must</strong> include:
          </div>
          <div id="includedTagsList" class="tagsList">
            <div class="dropdownContainer">
              <label for="checkbox" class="not-selectable pointer addButton">
                <div class="plusButton">+</div>
              </label>
              <input id="checkbox" class="filterCheckbox" type="checkbox" />
              <div id="includedTagsChoices" class="dropdown"></div>
            </div>
          </div>
        </div>
        <div id="excludedFilterLabel" class="filterLabel">
          tags <strong>must</strong> exclude:
        </div>
      </div>
    </details>

    <ol id="resultsList" style="width: 100%; padding: 0"></ol>
  </body>
  <script defer>
    const dles = [
  {
    "name": "Bandle",
    "url": "https://bandle.app/",
    "description": "Guess the song, one instrument at a time (sort of).",
    "tags": [
      "audio",
      "daily",
      "guessing",
      "music"
    ]
  },
  {
    "name": "Box Office Game",
    "url": "https://boxofficega.me/",
    "description": "Guess the top five movies in the US domestic box office for the given weekend.",
    "tags": [
      "daily",
      "guessing",
      "movies"
    ]
  },
  {
    "name": "Chronophoto",
    "url": "https://www.chronophoto.app/",
    "description": "Guess the year in which each picture was taken.",
    "tags": [
      "daily",
      "pictures",
      "time"
    ]
  },
  {
    "name": "Cine2Nerdle",
    "url": "https://www.cinenerdle2.app/",
    "description": "Rearrange the tiles into groups that represent movies/themes. Includes both Cine2Nerdle Original and Reversal.",
    "tags": [
      "daily",
      "movies"
    ]
  },
  {
    "name": "Colorfle",
    "url": "https://colorfle.org/index.html",
    "description": "Figure out the color composition of the given color.",
    "tags": [
      "colors",
      "daily",
      "guessing"
    ]
  },
  {
    "name": "Combinations",
    "url": "https://combinations.org/",
    "description": "Create words using combinations of letters from the grid.",
    "tags": [
      "daily",
      "words"
    ]
  },
  {
    "name": "Conexo",
    "url": "https://conexo.ws/en/daily",
    "description": "Form groups of 4 words that have something in common.",
    "tags": [
      "daily",
      "guessing",
      "words"
    ]
  },
  {
    "name": "Connections",
    "url": "https://www.nytimes.com/games/connections",
    "description": "Group words that share a common thread.",
    "tags": [
      "daily",
      "words"
    ]
  },
  {
    "name": "Contexto",
    "url": "https://contexto.me/",
    "description": "Guess words to see how close they are to the secret word in terms of context, eventually guessing the secret word.",
    "tags": [
      "daily",
      "guessing",
      "words"
    ]
  },
  {
    "name": "Costcodle",
    "url": "https://costcodle.com/",
    "description": "Guess the price of the given Costco item.",
    "tags": [
      "daily",
      "guessing",
      "prices"
    ]
  },
  {
    "name": "Crosswordle",
    "url": "https://crosswordle.vercel.app",
    "description": "Fill in the grid to logically fit a series of Wordle guesses.",
    "tags": [
      "daily",
      "wordle",
      "words"
    ]
  },
  {
    "name": "crosswordle.com",
    "url": "https://crosswordle.com/",
    "description": "Swap tiles to solve multiple Wordle puzzles crossed together.",
    "tags": [
      "daily",
      "wordle",
      "words"
    ]
  },
  {
    "name": "crosswordle.org",
    "url": "https://crosswordle.org/",
    "description": "Solve multiple Wordle puzzles crossed together.",
    "tags": [
      "daily",
      "wordle",
      "words"
    ]
  },
  {
    "name": "Daily Dozen Trivia",
    "url": "https://dailydozentrivia.com/",
    "description": "Answer 9 trivia questions from various categories.",
    "tags": [
      "daily",
      "trivia"
    ]
  },
  {
    "name": "Flagdle",
    "url": "https://www.flagdle.org/",
    "description": "Guess the country by its flag.",
    "tags": [
      "daily",
      "flags",
      "geography"
    ]
  },
  {
    "name": "Flagle",
    "url": "https://www.flagle.io/",
    "description": "Guess the flag in 5 guesses or less.",
    "tags": [
      "daily",
      "flags",
      "geography",
      "guessing"
    ]
  },
  {
    "name": "Framed",
    "url": "https://framed.wtf/",
    "description": "Guess the movie from 6 frames.",
    "tags": [
      "daily",
      "guessing",
      "movies",
      "pictures"
    ]
  },
  {
    "name": "Gamedle Artwork",
    "url": "https://www.gamedle.wtf/artwork",
    "description": "Guess the video game by its artwork.",
    "tags": [
      "art",
      "daily",
      "guessing",
      "pictures",
      "video games"
    ]
  },
  {
    "name": "Gamedle Classic",
    "url": "https://www.gamedle.wtf/classic",
    "description": "Guess the video game by its cover.",
    "tags": [
      "daily",
      "guessing",
      "pictures",
      "video games"
    ]
  },
  {
    "name": "Gamedle Classic Unlimited",
    "url": "https://www.gamedle.wtf/unlimited",
    "description": "Guess the video game by its cover, unlimited mode.",
    "tags": [
      "guessing",
      "pictures",
      "unlimited",
      "video games"
    ]
  },
  {
    "name": "Gamedle Guess",
    "url": "https://www.gamedle.wtf/guess",
    "description": "Guess the video game by its specifications.",
    "tags": [
      "daily",
      "guessing",
      "video games"
    ]
  },
  {
    "name": "Gamedle Keywords",
    "url": "https://www.gamedle.wtf/classic",
    "description": "Guess the video game by keywords.",
    "tags": [
      "daily",
      "guessing",
      "video games",
      "words"
    ]
  },
  {
    "name": "Globle",
    "url": "https://globle-game.com/game",
    "description": "Guess the mystery country, given how close it is to each guessed country.",
    "tags": [
      "daily",
      "geography",
      "guessing",
      "maps"
    ]
  },
  {
    "name": "Guess The Game",
    "url": "https://guessthe.game/",
    "description": "Guess the video game by its cropped screenshots.",
    "tags": [
      "daily",
      "guessing",
      "pictures",
      "video games"
    ]
  },
  {
    "name": "Housle",
    "url": "https://housle.house/game",
    "description": "Guess the price of the house, given pictures of parts of the house.",
    "tags": [
      "daily",
      "guessing",
      "prices"
    ]
  },
  {
    "name": "Immaculate Footy",
    "url": "https://www.immaculategrid.com/hockey",
    "description": "Fill out the grid with soccer players matching the criteria of both their row and column.",
    "tags": [
      "daily",
      "soccer"
    ]
  },
  {
    "name": "Immaculate Grid: Baseball",
    "url": "https://www.immaculategrid.com/",
    "description": "Fill out the grid with baseball players matching the criteria of both their row and column.",
    "tags": [
      "baseball",
      "daily"
    ]
  },
  {
    "name": "Immaculate Grid: Men's Basketball",
    "url": "https://www.immaculategrid.com/basketball/mens",
    "description": "Fill out the grid with men's basketball players matching the criteria of both their row and column.",
    "tags": [
      "basketball",
      "daily"
    ]
  },
  {
    "name": "Immaculate Grid: Pro Football",
    "url": "https://www.immaculategrid.com/football",
    "description": "Fill out the grid with pro football players matching the criteria of both their row and column.",
    "tags": [
      "daily",
      "football"
    ]
  },
  {
    "name": "Immaculate Grid: Women's Basketball",
    "url": "https://www.immaculategrid.com/basketball/womens",
    "description": "Fill out the grid with women's basketball players matching the criteria of both their row and column.",
    "tags": [
      "basketball",
      "daily"
    ]
  },
  {
    "name": "Metaflora",
    "url": "https://flora.metazooa.com/",
    "description": "Guess plants to see where they share common ancestors with the mystery plant, eventually guessing the mystery plant.",
    "tags": [
      "daily",
      "guessing",
      "science"
    ]
  },
  {
    "name": "Metazooa",
    "url": "https://metazooa.com/",
    "description": "Guess animals to see where they share common ancestors with the mystery animal, eventually guessing the mystery animal.",
    "tags": [
      "daily",
      "guessing",
      "science"
    ]
  },
  {
    "name": "MLB Pickle",
    "url": "https://www.mlbpickle.com/",
    "description": "Guess today's mystery MLB player within nine guesses.",
    "tags": [
      "baseball",
      "daily",
      "guessing"
    ]
  },
  {
    "name": "Movie Grid",
    "url": "https://moviegrid.io/",
    "description": "Fill out the grid with movies matching the criteria of both their row and column.",
    "tags": [
      "daily",
      "movies"
    ]
  },
  {
    "name": "Movie to Movie",
    "url": "https://movietomovie.com/",
    "description": "Connect two movies by jumping through actors and the movies they've been in.",
    "tags": [
      "daily",
      "movies"
    ]
  },
  {
    "name": "OEC Tradle",
    "url": "https://games.oec.world/en/tradle/",
    "description": "Guess the country by its exports.",
    "tags": [
      "daily",
      "geography",
      "guessing"
    ]
  },
  {
    "name": "Petdle",
    "url": "https://petdle.link/",
    "description": "Guess the pet taken from the game Super Auto Pets.",
    "tags": [
      "daily",
      "guessing",
      "video games"
    ]
  },
  {
    "name": "Puzzmo - Crossword",
    "url": "https://www.puzzmo.com/play/crossword",
    "description": "Crosswords without getting stuck.",
    "tags": [
      "daily",
      "puzzmo",
      "words"
    ]
  },
  {
    "name": "Puzzmo - Flipart",
    "url": "https://www.puzzmo.com/play/flip-art",
    "description": "Rotate the pieces to fit them within the frame.",
    "tags": [
      "daily",
      "puzzmo"
    ]
  },
  {
    "name": "Puzzmo - Really Bad Chess",
    "url": "https://www.puzzmo.com/play/really-bad-chess",
    "description": "Checkmate the opponent's king in this randomized Chess variant.",
    "tags": [
      "daily",
      "puzzmo"
    ]
  },
  {
    "name": "Puzzmo - Spelltower",
    "url": "https://www.puzzmo.com/play/spelltower",
    "description": "Find words to clear tiles in the falling grid.",
    "tags": [
      "daily",
      "puzzmo",
      "words"
    ]
  },
  {
    "name": "Puzzmo - Typeshift",
    "url": "https://www.puzzmo.com/play/typeshift",
    "description": "Slide columns of letters to make words, using all of the letters along the way.",
    "tags": [
      "daily",
      "puzzmo",
      "words"
    ]
  },
  {
    "name": "Semantle",
    "url": "https://semantle.com/",
    "description": "Guess words to see how close they are to the secret word semantically, eventually guessing the secret word.",
    "tags": [
      "daily",
      "guessing",
      "words"
    ]
  },
  {
    "name": "Songless",
    "url": "https://lessgames.com/songless",
    "description": "Guess the song from listening to small parts of it.",
    "tags": [
      "audio",
      "daily",
      "music"
    ]
  },
  {
    "name": "Spellcheck",
    "url": "https://spellcheck.xyz/",
    "description": "Spell the words correctly after listening to them.",
    "tags": [
      "audio",
      "daily",
      "words"
    ]
  },
  {
    "name": "TimeGuessr",
    "url": "https://timeguessr.com/",
    "description": "Guess the right time and location of each historical photo.",
    "tags": [
      "daily",
      "geography",
      "maps",
      "pictures",
      "time"
    ]
  },
  {
    "name": "travle",
    "url": "https://travle.earth/",
    "description": "Connect the starting country to the ending country by naming countries in between them.",
    "tags": [
      "daily",
      "geography",
      "maps"
    ]
  },
  {
    "name": "Weaver",
    "url": "https://weavergame.org/",
    "description": "Weave your way from the start word to the end word, changing only one letter at a time.",
    "tags": [
      "daily",
      "words"
    ]
  },
  {
    "name": "WhereTaken",
    "url": "https://wheretaken.teuteuf.fr/",
    "description": "Guess the Country/Region in which the photo was taken.",
    "tags": [
      "daily",
      "geography",
      "guessing",
      "pictures"
    ]
  },
  {
    "name": "WhereTaken USA",
    "url": "https://wheretakenusa.teuteuf.fr/",
    "description": "Guess the US State in which the photo was taken.",
    "tags": [
      "daily",
      "geography",
      "guessing",
      "pictures",
      "usa"
    ]
  },
  {
    "name": "Word Waffle",
    "url": "https://wordwaffle.org/",
    "description": "Move letters to create words both horizontally and vertically.",
    "tags": [
      "daily",
      "wordle",
      "words"
    ]
  },
  {
    "name": "Wordle",
    "url": "https://www.nytimes.com/games/wordle/index.html",
    "description": "Guess the 5-letter word in six or fewer attempts.",
    "tags": [
      "daily",
      "guessing",
      "wordle",
      "words"
    ]
  },
  {
    "name": "Wordless",
    "url": "https://lessgames.com/wordless",
    "description": "Solve Wordle puzzles of various sizes.",
    "tags": [
      "daily",
      "wordle",
      "words"
    ]
  },
  {
    "name": "Worldle",
    "url": "https://worldle.teuteuf.fr/",
    "description": "Guess the country by its shape on the world map.",
    "tags": [
      "daily",
      "geography",
      "maps"
    ]
  }
];

    let filtered_dles = dles;
    const allTags = dles
      .map((dle) => dle.tags)
      .flat()
      .filter((x, i, a) => a.indexOf(x) == i);
    allTags.sort();
    const tag_colors = {
  "baseball": "#e5bfb2",
  "wordle": "#e5b2db",
  "guessing": "#c9e5b2",
  "words": "#e5b2db",
  "time": "#cab2e5",
  "audio": "#e5bcb2",
  "basketball": "#e5bfb2",
  "music": "#b2e5e3",
  "puzzmo": "#b2c4e5",
  "usa": "#dab2e5",
  "video games": "#e1b2e5",
  "trivia": "#ceb2e5",
  "movies": "#b2e5e0",
  "flags": "#d9e5b2",
  "daily": "#e5d6b2",
  "football": "#d7e5b2",
  "art": "#e5bbb2",
  "soccer": "#c1b2e5",
  "colors": "#e5d1b2",
  "pictures": "#b2cae5",
  "maps": "#b2e5da",
  "prices": "#b2c6e5",
  "unlimited": "#d8b2e5",
  "science": "#bbb2e5",
  "geography": "#d0e5b2"
};

    const addIncludedTagButton = document.getElementById(
      "addIncludedTagButton"
    );
    const includedFilterLabel = document.getElementById("includedFilterLabel");
    const excludedFilterLabel = document.getElementById("excludedFilterLabel");
    const includedDropdownContainer = document.getElementById(
      "includedDropdownContainer"
    );
    const includedTagsList = document.getElementById("includedTagsList");
    const includedTagsChoices = document.getElementById("includedTagsChoices");
    const filterDetails = document.getElementById("filterDetails");
    const filterCheckboxes = document.getElementsByClassName("filterCheckbox");

    const dropdowns = document.getElementsByClassName("dropdown");
    const resultsList = document.getElementById("resultsList");

    let includedTags = ["daily"];
    let excludedTags = [];

    fillTagsList(includedTagsChoices, "includedTagOption");

    setResultsHTML();

    filterTags();
    checkTags();

    renderIncludedTags();

    function checkTags() {
      if (includedTags.length == 0) {
        includedFilterLabel.innerHTML =
          "tags <strong>must</strong> include: none";
      }
      if (excludedTags.length == 0) {
        excludedFilterLabel.innerHTML =
          "tags <strong>must</strong> exclude: none";
      }
    }

    function setResultsHTML() {
      resultsList.innerHTML = "";
      for (let dle of filtered_dles) {
        resultsList.innerHTML += dleToHTML(dle);
      }
    }

    function dleToHTML(dle) {
      return `<li style="display: flex; flex-direction: row; gap: 0.25rem; justify-content: space-between;">
      <div style="display: flex; flex-direction: column; gap: 0.25rem;">
        <div>
          <span style="font-size: 1.1rem;"><strong>${dle.name}</strong></span>
        <!-- <a style="font-size: 12px; color: darkgray; vertical-align: bottom;" href="${
          dle.url
        }">${dle.url}</a> -->
        </div>
        <div style="font-size: 0.8rem; line-height: 1.2;">
          ${dle.description}
        </div>
        ${tagsHtml(dle)}
      </div>
      <div style="display: flex; align-items: center; padding: 0.5rem;">
        <a href="${
          dle.url
        }" target="_blank"><button class="not-selectable" style="padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-size: 1.0rem">Play</button></a>
      </div>
    </li>`;
    }

    function tagHtml(tag) {
      return `<div style="background-color: ${tag_colors[tag]}; font-size: 0.7rem; padding: 0.1rem 0.3rem;" class="tag box-shadow not-selectable">
            ${tag}
        </div>`;
    }

    function tagsHtml(dle) {
      let html =
        '<div style="display:flex; row-gap: 0.25rem; column-gap: 0.5rem; flex-wrap: wrap; line-height: 1.2">';
      for (let tag of dle.tags) {
        html += tagHtml(tag);
      }
      html += "</div>";
      return html;
    }

    function renderIncludedTags() {
      for (let tag of includedTags) {
        includedTagsList.innerHTML =
          filterIncludedTagHtml(tag) + includedTagsList.innerHTML;
      }
    }

    function filterIncludedTagHtml(tag) {
      return `<div id="filter-tag-${tag}" class="includedTagItem tagItem box-shadow not-selectable" style="background-color: ${tag_colors[tag]}; font-size:0.7rem; padding: 0.1rem 0.3rem;">
            ${tag}
        </div>`;
    }

    function removeIncludedTag(element) {
      includedTags = includedTags.filter((tag) => tag == element.innerHTML);
      element.remove();
      filterTags();
    }

    function setOptions(selectionElement, options) {
      selectionElement.innerHTML = "";
      for (let option of options.sort()) {
        selectionElement.innerHTML += `
        <option value="${option}">${option}</option>
      `;
      }
    }

    function fillTagsList(element, className) {
      for (let tag of allTags) {
        element.innerHTML += `
        <li id="tag-${tag}" class="${className} tagItem not-selectable" style="background-color: ${tag_colors[tag]}">${tag}</li>
      `;
      }
    }

    function toggleShowTags() {
      for (let tag of includedTags) {
        let element = document.getElementById(`tag-${tag}`);
        element.classList.add("hidden");
      }
    }

    function filterIncludedTags() {
      toggleShowTags();
      filtered_dles = dles.filter((dle) =>
        includedTags.every((tag) => dle.tags.includes(tag))
      );
      setResultsHTML();
    }

    function filterexcludedTags() {
      filtered_dles = filtered_dles.filter(
        (dle) => !dle.tags.some((tag) => excludedTags.includes(tag))
      );
      setResultsHTML();
    }

    function filterTags() {
      filterIncludedTags();
      filterexcludedTags();
    }

    function closeDropdowns() {
      for (var i = 0; i < filterCheckboxes.length; i++) {
        filterCheckboxes[i].checked = false;
      }
    }

    document.addEventListener("click", function (e) {
      let classList = e.target.classList;
      if (classList.contains("filterCheckbox")) {
        for (var i = 0; i < dropdowns.length; i++) {
          console.log(dropdowns[i]);
          if (window.getComputedStyle(dropdowns[i]).style == "flex") {
            closeDropdowns();
            return;
          }
        }
        return;
      }
      if (!classList.contains("dropdown") && !classList.contains("tagItem")) {
        closeDropdowns();
      }
      if (classList.contains("includedTagItem")) {
        removeIncludedTag(e.target);
      }
      if (classList.contains("includedTagOption")) {
        includedTags.push(e.target.innerHTML);
        filterTags();
        renderIncludedTags();
        classList.add("hidden");
      }
    });

    document.addEventListener("keyup", function (e) {
      // ESCAPE KEY
      if (e.keyCode == 27) {
        closeDropdowns();
      }
    });
  </script>
  <style>
    html {
      font-family: sans-serif;
      font-size: 1.25em;
      max-width: 30rem;
      padding: 2rem;
      margin: auto;
      line-height: 1.5rem;
    }

    li {
      padding: 0.35rem;
    }
    li:nth-child(odd) {
      background-color: #dedede;
    }
    li:nth-child(even) {
      background-color: #efefef;
    }

    li > a {
      text-decoration: none;
    }
    .filterCheckbox {
      display: none;
    }
    .filterCheckbox:checked + div {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      width: 50%;
      justify-content: center;
      padding: 0.5rem;
    }

    button:hover {
      cursor: pointer;
    }

    .plusButton {
      background-color: #eeeeee;
      border-color: darkgray;
      padding: 0rem 0.3rem;
    }

    .tagItem {
      font-size: 0.7rem;
      padding: 0.1rem 0.3rem;
      cursor: pointer;
    }

    .tagsList {
      display: flex;
      row-gap: 0.25rem;
      column-gap: 0.5rem;
      flex-wrap: wrap;
      line-height: 1.2;
    }

    .filterLabel {
      font-size: 0.9rem;
      margin-right: 0.25rem;
    }

    .dropdown {
      display: none;
      list-style: none;
      padding-left: 0.5rem;
      position: absolute;
      left: 20%;
      background-color: white;
      margin: 0;
      box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
      -webkit-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
      -moz-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
    }

    .not-selectable {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    .pointer {
      cursor: pointer;
    }
    .hidden {
      display: none;
    }

    .box-shadow {
      box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
      -webkit-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
      -moz-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.75);
    }

    @media (max-width: 450px) {
      html {
        padding: 0.6rem;
      }
    }
  </style>
</html>
